  
/***************************************************************************
                 module classe T_profile.h  -  description

!Computation of : the ground temperature evolution
   !   objet:  computation of : the ground temperature evolution
    !   ------
    !   Method: implicit time integration
    !   -------
    !   Consecutives ground temperatures are related by:
    !           T(k+1) = C(k) + D(k)*T(k)  (1)
    !   the coefficients C and D are computed at the t-dt time-step.
    !   Routine structure:
    !   -new temperatures are computed  using (1)
    !    surface temperature

output:
	YS1 = ptn--->Different levels soil temperature
                             -------------------
 ***************************************************************************/

  //===========================================================================
  //                          methodes forward
  forward (YREAL dgrnd,YREAL cgrnd,YREAL temp_sol_new,YREAL ptn1,YREAL dgrnd1,YREAL cgrnd1,YREAL ptn_init, YREAL lam)
  {
	
	if(Yt == 1)
		YS1 = ptn_init;
	else
	{
		//temp_sol_new = 276.27;
		if(Yj == 0)
		{
			//poner inicializacion de cgrnd y dgrnd
			YS1 = (lam * cgrnd1 + temp_sol_new) / (lam * (1 - dgrnd1) + 1);
			//YS1 = (lambda * cgrnd1 + temp_sol_new) / (lambda * (1 - dgrnd1) + 1);			
			//printf(" tt %e      YS1 %e     lam %e   lambda %e \n",tt ,YS1, lam,lambda);

		}
		else
			YS1 = cgrnd + dgrnd * ptn1;

	
	}

	


	//printf("--------%d(%d,%d)cgrnd %e  dgrnd %e \n",Yt,Yi,Yj,cgrnd,dgrnd);
	//printf("%d(%d,%d) cgrnd %e   dgrnd %e --- cgrnd1 %e dgrnd1 %e ptn1: %e ptn: %e   tsol %e\n",Yt,Yi,Yj,cgrnd,dgrnd,cgrnd1,dgrnd1,ptn1,YS1,temp_sol_new);
	//printf("%d(%d,%d) dgrnd %e, cgrnd %e,     dgrnd1 %e cgrnd1 %e    temp_sol_new %e ,     ptn1 %e lambda %e YS1 %e \n",Yt, Yi, Yj, dgrnd, cgrnd, dgrnd1, cgrnd1, temp_sol_new,ptn1,lambda,YS1 );
  }
	

  //===========================================================================
  //                         methodes  backward
  backward  (YREAL dgrnd,YREAL cgrnd,YREAL temp_sol_new,YREAL ptn1,YREAL dgrnd1,YREAL cgrnd1,YREAL ptn_init, YREAL lam)
  {
	if(Yt == 1)
	{
		YJ1I1 = YJ1I2 =YJ1I3 =YJ1I4 =YJ1I5 =YJ1I6 = YJ1I8 = 0;
		YJ1I7 = 1;
	}
	else
	{
		//temp_sol_new = 276.27;
		if(Yj == 0)
		{
			//YS1 = (lam * cgrnd1 + temp_sol_new) / (lam * (1 - dgrnd1) + 1);
			//poner inicializacion de cgrnd y dgrnd
			/*YJ1I3 = 1 / (lambda * (1 - dgrnd1) + 1);
			YJ1I5 = (lambda * cgrnd1 + temp_sol_new)*lambda / pow(lambda * (1 - dgrnd1) + 1 , 2);
			YJ1I6 = lambda / (lambda * (1 - dgrnd1) + 1);*/
			YJ1I3 = 1 / (lam * (1 - dgrnd1) + 1);
			YJ1I5 = (lam * cgrnd1 + temp_sol_new)*lam / pow(lam * (1 - dgrnd1) + 1 , 2);
			YJ1I6 = lam / (lam * (1 - dgrnd1) + 1);
			YJ1I8 = ( cgrnd1+   (dgrnd1-1)*temp_sol_new  )/ pow(lam * (1 - dgrnd1) + 1 , 2);
			YJ1I1 =YJ1I2 = YJ1I4 =YJ1I7 = 0;
		}
		else
		{
			//poner inicializacion de cgrnd y dgrnd
			YJ1I1 = ptn1;
			YJ1I2 = 1;
			YJ1I4 = dgrnd;
			YJ1I3 =YJ1I5 = YJ1I6 =YJ1I7 =YJ1I8 =0;

		}
			
	}
	
	
  }

  //===========================================================================

//************************** FIN DU MODULE T_profile.h ********************************














