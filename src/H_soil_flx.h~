  
/*****************************************************************************
                 module classe H_soil_flux.h -  description

we have only one flux field corresponding to water evaporated from the surface

outputs:
	YS1 = zeflux--->Soil evaporation;
	YS2 = zpreci--->Soil precipitation;
                             -------------------
 ***************************************************************************/

  //===========================================================================
  //                          methodes forward
  forward (YREAL veget, YREAL transpir, YREAL precisol)
  {
	if(Yt > 1)
	{
		if( veget > 0 ) 
		{
			YS1 = transpir/veget;
			YS2 = precisol/veget;
		}
		else
		{
			YS1 = 0;
			YS2 = 0;
		}
	}
	else
	{
		YS1 = 0;
		YS2 = 0;
	}

	//printf("%d(%d,%d) veget %e, transpir %e, precisol %e, YS1 %e ,YS2 %e \n",Yt,Yi,Yj,veget, transpir, precisol, YS1, YS2);
  }
	

  //===========================================================================
  //                         methodes  backward
  backward (YREAL veget, YREAL transpir, YREAL precisol)
  {
	if(Yt > 1)
	{
		if( veget > 0 ) 
		{
			YJ1I1 = -transpir/pow(veget,2);
			YJ1I2 = 1/veget;
			YJ1I3 = 0;

			YJ2I1 = -precisol/pow(veget,2);
			YJ2I2 = 0;			
			YJ2I3 = 1/veget;
		}
		else
		{
			YJ1I1 =YJ1I2 =YJ1I3 = 0;
			YJ2I1 =YJ2I2 =YJ2I3 = 0;
		}
	}
	else
	{
		YJ1I1 =YJ1I2 =YJ1I3 = 0;
		YJ2I1 =YJ2I2 =YJ2I3 = 0;
	}
	
  }

  //===========================================================================

//************************** FIN DU MODULE H_soil_flx.h ***********************














