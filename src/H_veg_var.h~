  
/***************************************************************************
                 module classe H_veg_var.h  -  description

variacion de veget del PDT anterior con respecto al PDT actual

output: 
	YS1 = vmr--->VARIATION OF VEGET
	YS2 = qsintveg2--->Water on vegetation due to interception over old veget!

qsintveg2 is the intercepted water in mm if the total volume was redistributed over the previous "veget" fractions 
This the distribution of intercepted water that needs to be chnaged if "veget" changes

                             -------------------
 ***************************************************************************/

  //===========================================================================
  //                          methodes forward
  forward (YREAL veget, YREAL resdist, YREAL qsintveg)
  {

	if(Yt > 1)
	{
		//YS1-->VARIATION OF VEGET
		if (abs(veget-resdist) > 1e-20) 
			YS1 = veget-resdist;
		else
			YS1 = 0;		

		//YS2-->Water on vegetation due to interception over old veget
		if(resdist > 0)
			YS2 = qsintveg/resdist;
		else
			YS2 = 0;
	
		//printf("%d veget %e, resdist %e, qsintveg %e \n",Yt,veget, resdist, qsintveg);
		//printf("%d(%d,%d)  veget %e   resdist %e    qsintveg %e   YS1 %e   YS2 %e  \n",Yt,Yi,Yj,veget, resdist, qsintveg,YS1,YS2);
	
	}
	else
	{
		YS1 = 0;
		YS2 = 0;
	}


	//printf("%d(%d,%d) veget %e    resdist %e    qsintveg %e     YS1 %e     YS2 %e \n", Yt, Yi,Yj,veget , resdist, qsintveg, YS1, YS2);
  }
	

  //===========================================================================
  //                         methodes  backward
  backward (YREAL veget, YREAL resdist, YREAL qsintveg)
  {
	if(Yt > 1)
	{
		//YS1-->VARIATION OF VEGET
		//printf("veget %e, resdist %e, qsintveg %e \n",veget, resdist, qsintveg);
		if (abs(veget-resdist) >1e-20) 
		{			
			YJ1I1 = 1;
			YJ1I2 = -1;
			YJ1I3 = 0;
		}
		else
		{
			YJ1I1 = YJ1I2 = YJ1I3 =0;
			/*YJ1I1 = 1;
			YJ1I2 = -1;
			YJ1I3 = 0;*/
		}

		//YS2-->Water on vegetation due to interception over old veget
		if(resdist >0)
		{
			YJ2I1 = 0;
			YJ2I2 = -qsintveg/pow(resdist,2);
			YJ2I3 = 1/resdist;

			
		}
		else
		{
			YJ2I1 = YJ2I2 = YJ2I3 =0;
		}
	
		//printf("%d(%d,%d)  veget %e   resdist %e    qsintveg %e   YS1 %e   YS2 %e  \n",Yt,Yi,Yj,veget, resdist, qsintveg,YS1,YS2);
	
	}
	else
	{
		YJ1I1 = YJ1I2 = YJ1I3 =0;
		YJ2I1 = YJ2I2 = YJ2I3 =0;
	}
	
  }

  //===========================================================================

//************************** FIN DU MODULE H_veg_var.h  ********************************














