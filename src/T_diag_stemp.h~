/*  
  ***************************************************************************
                 module classe T_diag_stemp.h  -  description

SALIDA : YS1 = stempdiag; profile de temperatures (stempdiag)
                             -------------------
 ***************************************************************************/

  //===========================================================================
  //                          methodes forward
  forward ()
  {
	double x = 0;
	double x1 = 0;
	double p;
	double w;
	for(int k = 0 ; k < ngrnd ; k++)
	{
		//YS_T_diag_stemp(0,Yi,Yj,Yt) = YS_T_diag_stemp(0,Yi,Yj,Yt) + intfactw_s[Yj][k] * YS_T_profile(0,Yi,k,Yt);
		p = Yting[k]; //_T_profile(0,Yi,k,Yt);
		x+= intfactw_s[Yj][k] * p;

		w = Yting[k+7];
		x1+= w * p;

		//printf("%d- x %e   x1 %e  \n",Yj,x1,x);

        	//printf("%d(%d,%d,%d) stemp %e  huminit %e  profile %e  \n ",Yt, Yi,Yj,k,YS_T_diag_stemp(0,Yi,Yj,Yt), intfactw_s[Yj][k] , YS_T_profile(0,Yi,k,Yt));
	}

	YS1 = x1;
	//printf("%d(%d,%d) stemp %e  \n ",Yt, Yi,Yj,YS_T_diag_stemp(0,Yi,Yj,Yt));
  }
	

  //===========================================================================
  //                         methodes  backward
  backward ()
  {
	/*double p,w;
	for (int k=0 ; k< ngrnd ; k++)
	{
		p = Yting[k];
		w = Yting[k+7];
		YG1_T_profile(Yi,k,Yt)+=intfactw_s[Yj][k]*YG1_T_diag_stemp(Yi,Yj,Yt);
		Yjac[0][k] = intfactw_s[Yj][k];
	}*/

	double w, p;

	//int i = 0;

	for (int k=0 ; k < ngrnd *2 ; k++)
	{
		w = Yting[k+ngrnd];
		p= Yting[k];
		//YG1_H_soil_shum(Yi,k,Yt)+=intfactw_w[Yj][k]*YG1_T_hum_wet(Yi,Yj,Yt);
		if(k < 7)
			Yjac[0][k] = Yting[k+ngrnd];
		else
			Yjac[0][k] = w = Yting[k-ngrnd];
		//Yjac[1][k] = p;

		//printf(" p %e    w %e  \n\n",p,w);
	
	}

	
  }

  //===========================================================================

//************************** FIN DU MODULE T_diag_stemp.h ************************






