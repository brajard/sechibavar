  
/***************************************************************************
                 module classe E_emis_planck.h  -  description
                             -------------------
Calcul de l’energie emise par la surface dans la bande 8-14microns :

output---> emis_s


 ***************************************************************************/

  //===========================================================================
  //                          methodes forward
  forward (YREAL temp_sol, YREAL emis_s1)
  {
	double a;
	double b;
	double rad;
	double lambda;

	//if(Yt > 1)
	//{
		//nlamb=NINT((lambda2-lambda1)/dlambda)
		// IF (ABS(lambda2-lambda1) .LT. EPSILON) THEN
		//     nlamb = 1
		//     dlambda = 1.
		//  END IF

		if(Yj == 0)	
			YS1 = 0;
		else
		{
			lambda = lambda1 + (Yj - 1) * dlambda;
			a = 2 * hc * ch * ch * pow(lambda,-5);
			b = exp( hc * ch / ( lambda * kb * temp_sol)) - 1;
			rad = pi * a / b;
			YS1 = emis_s1 + rad * dlambda;
		}

		//printf("%d,%d    tsol %e     YS1 %e \n",Yt,Yj,temp_sol,YS1);
	//}
	//else
	//	YS1 = 0;

	//printf("%d,%d    tsol %e     YS1 %e \n",Yt,Yj,temp_sol,YS1);
   }
	

  //===========================================================================
  //                         methodes  backward
  backward (YREAL temp_sol, YREAL emis_s1)
  {

	double a;
	double b;
	double rad;
	double lambda;

	double d_b_tempsol = 0;
	double d_rad_b = 0;

	//if(Yt > 1)
	//{
		if(Yj == 0)	
			YJ1I1 = YJ1I2 = 0;
		else
		{
			lambda = lambda1 + (Yj - 1) * dlambda;
			a = 2 * hc * ch * ch * pow(lambda,-5);

			b = exp( hc * ch / ( lambda * kb * temp_sol)) - 1;
			d_b_tempsol = -(hc * ch / ( lambda * kb * temp_sol * temp_sol)) * exp( hc * ch / ( lambda * kb * temp_sol));
					
			rad = pi * a / b;
			d_rad_b = -pi * a / (b*b);

			
			YJ1I1 = 1;
			YJ1I2 = dlambda * d_rad_b * d_b_tempsol;

		}

	
	//}
	//else
	//	YJ1I1 =YJ1I2 = 0;

	

  }

  //===========================================================================

//************************** FIN DU MODULE E_emis_planck.h ********************************


