  
/***************************************************************************
                 module classe S_veget.h  -  description

Fraction of vegetation type - fraction de surface effectivement couverte par un PFT

veget = vegetmax(1-exp(v*lai)) 

v---> extinction coefficient of the Monsi&Seaki relationship (1953)



                             -------------------
 ***************************************************************************/

  //===========================================================================
  //                          methodes forward
  forward (YREAL veget_max, YREAL lai, YREAL veget_diff1 )
  {
	/*if(Yt < 49) //solo el primer dia
	{	
		if(sechiba_vegmax[0][Yj] !=0)
			YS1 = sechiba_vegmax[0][Yj];
		else
			YS1 = 0;
		
		YS2 = 0;
	}	
	else
	{*/
		if(Yj ==0)
			YS1 = veget_max + veget_diff1;
		else
		{
			YS1 = veget_max * ( 1 - exp(-lai*ext_coef[Yj]));	
			YS2 = veget_diff1 + veget_max - (veget_max * ( 1 - exp(-lai*ext_coef[Yj])) );
		}
	//}        
	// printf("%d: (%d,%d) veget_max: %e    lai: %e     veget_diff1: %e     YS1: %e      YS2: %e \n ",Yt,Yi,Yj, veget_max, lai, veget_diff1, YS1, YS2);
	//printf("%d(%d,%d) veget %e   lai %e    veget_diff %e \n", Yt,Yi,Yj,YS1,lai,veget_diff1);


  }
	

  //===========================================================================
  //                         methodes  backward
  backward (YREAL veget_max, YREAL lai, YREAL veget_diff1 )
  {

	/*if(Yt < 49) //solo el primer dia
	{	
		YJ1I1 = 0;
		YJ1I2 = YJ1I3 =  0;
		YJ2I1 = YJ2I2 = YJ2I3 =  0;
	}	
	else
	{*/
		if(Yj ==0)
		{
			YJ1I1 = YJ1I3 = 1;
			YJ1I2 = 0;
		}
		else
		{
			//YS1 = veget_max * ( 1 - exp(-lai*ext_coef[Yj]));	
			//YS2 = veget_diff1 + veget_max - (veget_max * ( 1 - exp(-lai*ext_coef[Yj])) );

			YJ1I1 = ( 1 - exp(-lai*ext_coef[Yj]));
			YJ1I2 = veget_max * exp(-lai*ext_coef[Yj]) * ext_coef[Yj];
			YJ1I3 = 0;

			YJ2I1 = 1 - ( 1 - exp(-lai*ext_coef[Yj]));
			YJ2I2 = -veget_max * exp(-lai*ext_coef[Yj]) * ext_coef[Yj];
			YJ2I3 = 1;
		}
	//}        

	

  }

  //===========================================================================

//************************** FIN DU MODULE S_veget.h  **********************














